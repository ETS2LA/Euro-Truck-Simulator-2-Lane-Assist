<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:views="clr-namespace:ETS2LA.UI.Views"
             x:Class="ETS2LA.UI.Views.ManagerView"
             x:DataType="views:ManagerView">
    <UserControl.Resources>
        <ItemsPanelTemplate x:Key="WrapPanelTemplate">
            <WrapPanel HorizontalAlignment="Stretch" ItemWidth="360" ItemHeight="170"/>
        </ItemsPanelTemplate>
    </UserControl.Resources>

    <UserControl.Styles>
        <Style Selector="ToggleSwitch.plugin">
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Width" Value="48"/>
            <Setter Property="Height" Value="26"/>
        </Style>
        </UserControl.Styles>

    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
        <StackPanel Spacing="14">
            <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                <StackPanel Spacing="6">
                    <TextBlock Text="Plugins Manager" FontSize="20" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    <TextBlock Text="Enable, disable, and inspect plugins. Cards are generated automatically from plugin assemblies."
                               Foreground="{DynamicResource TextSecondaryBrush}" FontSize="13.5"/>
                </StackPanel>
                <Button Content="Refresh"
                        Padding="12 8"
                        Margin="12 0 0 0"
                        Background="#262B33"
                        BorderBrush="#2F353F"
                        Foreground="{DynamicResource TextPrimaryBrush}"
                        CornerRadius="8"
                        Click="OnRefreshClick"/>
            </StackPanel>

            <ItemsControl x:Name="PluginList" ItemsSource="{Binding Plugins}" ItemsPanel="{StaticResource WrapPanelTemplate}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate x:DataType="views:PluginItem">
                        <Border Background="{Binding CardBackground}"
                                BorderBrush="#2A2F37"
                                BorderThickness="1.2"
                                CornerRadius="14"
                                Padding="12"
                                Margin="0 0 12 12"
                                HorizontalAlignment="Left"
                                Tag="{Binding}"
                                Cursor="Hand"
                                PointerReleased="OnCardPointerReleased">
                            <Grid RowDefinitions="Auto,*,Auto" ColumnDefinitions="*">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <Border Width="36" Height="36" CornerRadius="9" Background="#262B33" BorderBrush="#2F353F" BorderThickness="1">
                                        <TextBlock Text="{Binding Initials}" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    </Border>
                                    <StackPanel Spacing="2" MaxWidth="280">
                                        <TextBlock Text="{Binding Name}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" FontSize="14.5"/>
                                        <TextBlock Text="{Binding Description}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="12.5" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </StackPanel>

                                <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding StatusText}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                                    <ToggleSwitch Classes="plugin"
                                                  IsChecked="{Binding IsEnabled}"
                                                  OffContent=""
                                                  OnContent=""/>
                                </StackPanel>

                                <TextBlock Grid.Row="2"
                                           Text="Click card to toggle. Settings in sidebar."
                                           Foreground="{DynamicResource TextMutedBrush}"
                                           FontSize="12"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <Border x:Name="PlaceholderPanel" Background="#16181D" BorderBrush="#2A2F37" BorderThickness="1" CornerRadius="12" Padding="14" IsVisible="False">
                <StackPanel Spacing="6">
                    <TextBlock Text="No plugins found" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    <TextBlock Text="Drop plugin DLLs into the Plugins folder (or build existing plugin projects) and hit Refresh."
                               Foreground="{DynamicResource TextSecondaryBrush}" FontSize="13.5"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
